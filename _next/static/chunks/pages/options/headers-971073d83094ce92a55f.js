_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"/D4B":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/options/headers",function(){return n("Y1lI")}])},Y1lI:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n("nKUr"),o=n("YFqc"),s=n.n(o);function a(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"jumbotron",children:Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("div",{className:"row",children:Object(r.jsxs)("div",{className:"col-lg-8 offset-lg-2",children:[Object(r.jsx)("h1",{className:"display-4",children:"Playground & Voyager Headers"}),Object(r.jsx)("p",{className:"lead",children:Object(r.jsx)(s.a,{href:"/options",children:Object(r.jsx)("a",{children:"\u2190 Back to all options"})})})]})})})}),Object(r.jsx)("main",{className:"container",children:Object(r.jsx)("div",{className:"row",children:Object(r.jsxs)("div",{className:"col-lg-8 offset-lg-2",children:[Object(r.jsxs)("p",{children:["If you\u2019re using one/some of the"," ",Object(r.jsx)(s.a,{href:"/options/middleware",children:Object(r.jsx)("a",{children:"middleware options"})})," ","to verify headers or cookies, or for some other way of authenticating requests, you will need to pass this (or a similar) authentication to the playgrounds and voyager so they can communicate with your graphql and/or mockql endpoints."]}),Object(r.jsx)("h2",{children:"Why Headers?"}),Object(r.jsxs)("p",{children:["Not really ",Object(r.jsx)("em",{children:"Why use headers"}),", but more of a question of"," ",Object(r.jsx)("em",{children:"Why we need to use headers"}),"? The playgrounds and voyager make ",Object(r.jsx)("code",{children:"POST"})," requests to your endpoints. The"," ",Object(r.jsx)("code",{children:"body"})," of the request is your query (or an introspection query for voyager), but the request also includes optional headers. If you're using a middleware to require a valid token as a header, you\u2019ll need to pass that through the playground or voyager so they can make authenticated requests."]}),Object(r.jsx)("p",{children:"As an example..."}),Object(r.jsxs)("h2",{children:["Using ",Object(r.jsx)("code",{children:"graphPlaygroundHeaders"})," (or"," ",Object(r.jsx)("code",{children:"mockPlaygroundHeaders"})," or ",Object(r.jsx)("code",{children:"voyagerHeaders"}),")"]}),Object(r.jsxs)("p",{children:["In ",Object(r.jsx)("code",{children:"graphMiddleware"}),", you"," ",Object(r.jsx)(s.a,{href:"/options/middleware#verify-request-headers",children:Object(r.jsx)("a",{children:"verified Firebase ID Tokens"})})," ",'passed as a header ("X-Token") before allowing access to the graphql endpoint. Now, you\u2019ll want to send that token to your playground as well so it can make authenticated requests. To do so, ',Object(r.jsx)("code",{children:"graphPlaygroundHeaders"})," takes a function that returns a JSON object of headers to include in the request."]}),Object(r.jsx)("pre",{className:"bg-light p-3",children:Object(r.jsxs)("code",{children:[Object(r.jsxs)("span",{className:"text-muted",children:["// We use ES6+ and typescript in our projects,",Object(r.jsx)("br",{}),"// but you can adjust this to use commonjs"]}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),'import * as functions from "firebase-functions"\nimport * as admin from "firebase-admin"\n\nimport { GraphQLFirebase } from "@undefinedai/graphql-firebase"\n\nconst graphPlaygroundHeaders = (req: express.Request) => {\n  const idToken = req.get("X-Token")\n  return {\n    "X-Token": idToken\n  }\n}\n\nexport const graphql = functions.https.onRequest(GraphQLFirebase({ \n  graphPlaygroundHeaders\n}))']})}),Object(r.jsx)("p",{children:"So now, in the full circle of life, here\u2019s how it works:"}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:'A request with an "X-Token" header is made to the playground'}),Object(r.jsx)("li",{children:'The "X-Token" header is used in the playground\u2019s query to the graphql endpoint'}),Object(r.jsx)("li",{children:'The graphql endpoint\u2019s middleware authenticates the "X-Token" header and processes the request'})]}),Object(r.jsx)("h2",{children:"But how do I add headers to my requests on the GraphQL Firebase pages?"}),Object(r.jsx)("p",{children:"That\u2019s a great question. Authentication is hard work. So we\u2019ve provided you a number of options here:"}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(s.a,{href:"/options/disable-features",children:Object(r.jsx)("a",{children:"Disable the pages"})})}),Object(r.jsx)("li",{children:"Customize the templates to add your authentication"}),Object(r.jsx)("li",{children:"Override the templates completely"})]}),Object(r.jsx)("p",{children:Object(r.jsx)(s.a,{href:"/options",children:Object(r.jsx)("a",{children:"\u2190 Back to all options"})})})]})})})]})}},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),o=n("284h");t.__esModule=!0,t.default=void 0;var s=o(n("q1tI")),a=n("elyg"),c=n("nOHt"),i=n("vNVm"),l={};function d(e,t,n,r){if((0,a.isLocalURL)(t)){e.prefetch(t,n,r).catch((function(e){0}));var o=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;l[t+"%"+n+(o?"%"+o:"")]=!0}}var u=function(e){var t=!1!==e.prefetch,n=(0,c.useRouter)(),o=n&&n.pathname||"/",u=s.default.useMemo((function(){var t=(0,a.resolveHref)(o,e.href,!0),n=r(t,2),s=n[0],c=n[1];return{href:s,as:e.as?(0,a.resolveHref)(o,e.as):c||s}}),[o,e.href,e.as]),h=u.href,f=u.as,p=e.children,j=e.replace,b=e.shallow,y=e.scroll,m=e.locale;"string"===typeof p&&(p=s.default.createElement("a",null,p));var O=s.Children.only(p),g=O&&"object"===typeof O&&O.ref,x=(0,i.useIntersection)({rootMargin:"200px"}),v=r(x,2),w=v[0],q=v[1],k=s.default.useCallback((function(e){w(e),g&&("function"===typeof g?g(e):"object"===typeof g&&(g.current=e))}),[g,w]);(0,s.useEffect)((function(){var e=q&&t&&(0,a.isLocalURL)(h),r="undefined"!==typeof m?m:n&&n.locale,o=l[h+"%"+f+(r?"%"+r:"")];e&&!o&&d(n,h,f,{locale:r})}),[f,h,q,m,t,n]);var T={ref:k,onClick:function(e){O.props&&"function"===typeof O.props.onClick&&O.props.onClick(e),e.defaultPrevented||function(e,t,n,r,o,s,c,i){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,a.isLocalURL)(n))&&(e.preventDefault(),null==c&&(c=r.indexOf("#")<0),t[o?"replace":"push"](n,r,{shallow:s,locale:i}).then((function(e){e&&c&&(window.scrollTo(0,0),document.body.focus())})))}(e,n,h,f,j,b,y,m)},onMouseEnter:function(e){(0,a.isLocalURL)(h)&&(O.props&&"function"===typeof O.props.onMouseEnter&&O.props.onMouseEnter(e),d(n,h,f,{priority:!0}))}};return(e.passHref||"a"===O.type&&!("href"in O.props))&&(T.href=(0,a.addBasePath)((0,a.addLocale)(f,"undefined"!==typeof m?m:n&&n.locale,n&&n.defaultLocale))),s.default.cloneElement(O,T)};t.default=u},vNVm:function(e,t,n){"use strict";var r=n("J4zp"),o=n("TqRt");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,n=e.disabled||!c,o=(0,s.useRef)(),l=(0,s.useState)(!1),d=r(l,2),u=d[0],h=d[1],f=(0,s.useCallback)((function(e){o.current&&(o.current(),o.current=void 0),n||u||e&&e.tagName&&(o.current=function(e,t,n){var r=function(e){var t=e.rootMargin||"",n=i.get(t);if(n)return n;var r=new Map,o=new IntersectionObserver((function(e){e.forEach((function(e){var t=r.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return i.set(t,n={id:t,observer:o,elements:r}),n}(n),o=r.id,s=r.observer,a=r.elements;return a.set(e,t),s.observe(e),function(){s.unobserve(e),0===a.size&&(s.disconnect(),i.delete(o))}}(e,(function(e){return e&&h(e)}),{rootMargin:t}))}),[n,t,u]);return(0,s.useEffect)((function(){c||u||(0,a.default)((function(){return h(!0)}))}),[u]),[f,u]};var s=n("q1tI"),a=o(n("0G5g")),c="undefined"!==typeof IntersectionObserver;var i=new Map}},[["/D4B",0,1,2]]]);