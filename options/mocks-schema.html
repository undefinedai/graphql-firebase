<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/><link rel="icon" href="/favicon.png" type="image/png"/><title>GraphQL Firebase</title><meta content="The easiest, fastest, and most flexible way to add a GraphQL server to your Firebase Functions. Complete with mocking, playgrounds, GraphQL Voyager, and Firebase Hosting integration for a custom url." name="description"/><meta name="next-head-count" content="5"/><link rel="preload" href="/graphql-firebase/_next/static/css/0f63b1889cd5ef8ceb09.css" as="style"/><link rel="stylesheet" href="/graphql-firebase/_next/static/css/0f63b1889cd5ef8ceb09.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/graphql-firebase/_next/static/chunks/main-038f0ad25f6c94d56cb6.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/framework.017c4b60e3e1f640722e.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/31664189.14c810a99516a2889994.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/d3071e6a.6de1b3e704db25d01376.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/09875f0d519b869f04a180ec93651cbe4028bec0.08f60211de5ae67cc683.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/pages/_app-09fe1f8271823d2bd292.js" as="script"/><link rel="preload" href="/graphql-firebase/_next/static/chunks/pages/options/mocks-schema-45b517e592abbc34db3a.js" as="script"/></head><body><div id="__next"><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><a class="navbar-brand" href="/graphql-firebase">GraphQL Firebase</a><button aria-controls="navbar" type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed"><span class="navbar-toggler-icon"></span></button><div class="navbar-collapse collapse" id="navbar"><div class="mr-auto navbar-nav"><a class="nav-link" href="/graphql-firebase/features">Features</a><a class="nav-link" href="/graphql-firebase/installation">Getting Started</a><a class="nav-link" href="/graphql-firebase/options">Options</a><a class="nav-link" href="/graphql-firebase/firebase-hosting">Custom URL</a></div><div class="navbar-nav"><a href="https://github.com/undefinedai/graphql-firebase" data-rb-event-key="https://github.com/undefinedai/graphql-firebase" class="nav-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.1" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 0.198c-4.418 0-8 3.582-8 8 0 3.535 2.292 6.533 5.471 7.591 0.4 0.074 0.547-0.174 0.547-0.385 0-0.191-0.008-0.821-0.011-1.489-2.226 0.484-2.695-0.944-2.695-0.944-0.364-0.925-0.888-1.171-0.888-1.171-0.726-0.497 0.055-0.486 0.055-0.486 0.803 0.056 1.226 0.824 1.226 0.824 0.714 1.223 1.872 0.869 2.328 0.665 0.072-0.517 0.279-0.87 0.508-1.070-1.777-0.202-3.645-0.888-3.645-3.954 0-0.873 0.313-1.587 0.824-2.147-0.083-0.202-0.357-1.015 0.077-2.117 0 0 0.672-0.215 2.201 0.82 0.638-0.177 1.322-0.266 2.002-0.269 0.68 0.003 1.365 0.092 2.004 0.269 1.527-1.035 2.198-0.82 2.198-0.82 0.435 1.102 0.162 1.916 0.079 2.117 0.513 0.56 0.823 1.274 0.823 2.147 0 3.073-1.872 3.749-3.653 3.947 0.287 0.248 0.543 0.735 0.543 1.481 0 1.070-0.009 1.932-0.009 2.195 0 0.213 0.144 0.462 0.55 0.384 3.177-1.059 5.466-4.057 5.466-7.59 0-4.418-3.582-8-8-8z"></path></svg></a><a href="https://www.npmjs.com/package/@undefinedai/graphql-firebase" data-rb-event-key="https://www.npmjs.com/package/@undefinedai/graphql-firebase" class="nav-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.1" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 0v16h16v-16h-16zM13 13h-2v-8h-3v8h-5v-10h10v10z"></path></svg></a></div></div></nav><div class="jumbotron"><div class="container"><div class="row"><div class="col-lg-8 offset-lg-2"><h1 class="display-4">Custom Mocks &amp; Schemas</h1><p class="lead"><a href="/graphql-firebase/options">← Back to all options</a></p></div></div></div></div><main class="container"><div class="row"><div class="col-lg-8 offset-lg-2"><p>GraphQL servers work off two main concepts - <code>typeDefs</code> <!-- -->and <code>resolvers</code>. Put those together, and you have a<!-- --> <code>schema</code>. Pass your <code>schema</code> to GraphQL Firebase, and you have a custom GraphQL server.</p><p>GraphQL Firebase uses<!-- --> <a href="https://github.com/ardatan/graphql-tools">@graphql-tools</a> <!-- -->under the hood, and for convenience, re-exports a few functions so you don&#x27;t need to bring the package back in (unless you need more from it).</p><p>Here’s an example of how to create a simple schema and pass it to GraphQL Firebase.</p><pre class="bg-light p-3"><code><span class="text-muted">// We use ES6+ and typescript in our projects,<br/>// but you can adjust this to use commonjs</span><br/><br/>import * as functions from &quot;firebase-functions&quot;

import { GraphQLFirebase, makeExecutableSchema } from &quot;@undefinedai/graphql-firebase&quot;

const typeDefs = `
  type Post {
    id: ID!
    title: String
    author: String
    votes: Int
  }

  # the schema allows the following query:
  type Query {
    posts: [Post]
  }

  # this schema allows the following mutation:
  type Mutation {
    upvotePost (
      postId: ID!
    ): Post
  }`

const resolvers = {
  Query: {
    posts() {
      return posts;
    },
  },
  Mutation: {
    upvotePost(_, { postId }) {
      const post = find(posts, { id: postId });
      if (!post) {
        throw new Error(`Couldn&#x27;t find post with id ${postId}`);
      }
      post.votes += 1;
      return post;
    },
  }
}

const schema = makeExecutableSchema({
  typeDefs,
  resolvers,
});

export const graphql = functions.https.onRequest(GraphQLFirebase({ schema }))</code></pre><p>In addition to <code>makeExecutableSchema</code>, we also re-export <code>loadFilesSync</code>, <code>mergeResolvers</code>, and <code>mergeTypeDefs</code> from<!-- --> <a href="https://github.com/ardatan/graphql-tools">@graphql-tools</a> <!-- -->so that you can easily split your typeDefs and resolvers into multiple files. If you need more functionality from that package, you should bring it into your project.</p><h2>Adding Custom Mocks</h2><p>By default, the MockQL server will try to read your typeDefs and supply sensible (albeit boring) mock data values. You can customize this further by passing your own mocks.</p><p>For example, say you don’t want each MockQL<!-- --> <code>Post</code> to have a default mock title of &quot;Hello World&quot; (the default mock <code>String</code>). You can bring in a mock data generator (or supply a custom one) to randomize returned values.</p><p>Building on the above example:</p><pre class="bg-light p-3"><code>import * as functions from &quot;firebase-functions&quot;

import { GraphQLFirebase, makeExecutableSchema } from &quot;@undefinedai/graphql-firebase&quot;<br/><br/><span class="text-muted">// Assuming you bring in the `casual` package</span><br/>import casual from &quot;casual&quot;<br/><br/><span class="text-muted">// Same schema creation as above, and then...</span><br/><br/>const mocks = {
  Query: () =&gt; ({
    posts: () =&gt; new MockList([3, 12]),
  }),
  Post: () =&gt; ({
    id: casual.uuid,
    title: casual.title,
    author: casual.full_name,
    votes: casual.integer(from = 0, to = 100)
  }),
}

export const graphql = functions.https.onRequest(GraphQLFirebase({
  mocks,
  schema
}))</code></pre><p>In this example, a query to <code>posts</code> will return a list of fake posts between 3 and 12 entries long, and each<!-- --> <code>Post</code> will have a randomly generated it, title, author name, and number of likes (between 0 and 100).</p><p>Pretty nifty, eh?</p><h2>Maintaing Resolvers with <code>preserveResolvers</code></h2><p>By default, the MockQL server will <em>always</em> return mock data, even if you don’t supply custom mocks and even if you have live, working resolves on your GraphQL server. You can change this behavior with <code>preserveResolvers</code>.</p><p>If you want the MockQL server to use your actual resolvers when they exist, and to only mock data when a particular resolver doesn’t exist, set <code>preserveResolvers: true</code>.</p><pre class="bg-light p-3"><code><span class="text-muted">// Keeping the same set-up from above</span><br/>export const graphql = functions.https.onRequest(GraphQLFirebase({
  mocks,
  preserveResolvers: true,
  schema
}))</code></pre><p><a href="/graphql-firebase/options">← Back to all options</a></p></div></div></main><div class="my-5 mx-auto text-center" style="max-width:540px"><hr/><small class="text-muted">Docs updated<!-- --> <!-- -->December 29, 2020, 1:17:30 AM UTC</small></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/options/mocks-schema","query":{},"buildId":"x_jLAqNvoVeCQHPOaVttD","assetPrefix":"/graphql-firebase","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/graphql-firebase/_next/static/chunks/polyfills-088f2db4a64647850150.js"></script><script src="/graphql-firebase/_next/static/chunks/main-038f0ad25f6c94d56cb6.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/framework.017c4b60e3e1f640722e.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/31664189.14c810a99516a2889994.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/d3071e6a.6de1b3e704db25d01376.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/09875f0d519b869f04a180ec93651cbe4028bec0.08f60211de5ae67cc683.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/pages/_app-09fe1f8271823d2bd292.js" async=""></script><script src="/graphql-firebase/_next/static/chunks/pages/options/mocks-schema-45b517e592abbc34db3a.js" async=""></script><script src="/graphql-firebase/_next/static/x_jLAqNvoVeCQHPOaVttD/_buildManifest.js" async=""></script><script src="/graphql-firebase/_next/static/x_jLAqNvoVeCQHPOaVttD/_ssgManifest.js" async=""></script></body></html>